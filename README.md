# py_schedule_core
定时执行EXE程序

### 项目背景

公司的AGV项目，将物料从压机搬运到烧结炉并入料，涉及三端：TC、IOT、RCS。

- TC负责控制整个业务流程
- IOT获取设备PLC的数据点位信息和给现场压机等设备发送指令。IOT给设备下指令，本质上是IOT给PLC写入值。PLC和IOT通信依靠工业网关。
- RCS负责控制AGV小车，将物料从A点搬运中转车到B点

### 问题点

1. IOT平台的驱动有未知原因的问题，IOT上设备可能隔几星期就偶发性全掉线，导致AGV控制出错。重启驱动后，设备重新在线。
2. 工业网关偶发性掉线，加之现场环境复杂，运行不稳定，常会突发掉线。

### 解决方案

1. 写自动化程序，使用selinium模块，驱动浏览器，模拟用户登录，依次点击，获取网页上某xpath的值是否为0，如果为0则发送邮件给指定人员，以起到预警提示作用。
   该自动化程序每5分钟运行一次。
2. 写py程序，不断ping工业网关的ip，如ping 10.10.0.1，当监测到ip掉线，则记录到数据库中，并记录当前在线or掉线状态，后续检测到ip状态发生变化(在线->掉线，掉线->在线)时，则更新状态表，并通过企业微信群机器人推送消息。
   该程序每两分钟执行一次

### **-本程序作用-**

写完前两个自动化程序后，原本是通过.bat程序实现定时执行.exe的

后续发现因每个程序的执行时间不同，需要多个.bat混乱，不利于管理

因此写本程序，管理多个EXE，定时执行



